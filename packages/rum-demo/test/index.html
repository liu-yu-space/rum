<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>RUM 测试页面</title>
  </head>
  <body>
    <h1>RUM 请求与上传测试</h1>
    <button id="requestBtn">发送请求</button>
    <p>点击按钮发送请求，查看控制台输出</p>
    <input type="file" id="fileInput" />
    <button id="uploadBtn">上传</button>
    <script type="module">
      // 拦截请求和响应
      import { worker } from "../mocks/browser.js";
      worker.start();

      // 测试请求
      import { request } from "rum/index.ts";

      document.getElementById("requestBtn").onclick = async () => {
        console.log("请求按钮被点击了");
        const reqInterceptors = [
          (config) => {
            config.headers = {
              ...config.headers,
              Authorization: "Bearer token",
            };
            return config;
          },
        ];

        const resInterceptors = [
          async (res) => {
            if (!res.ok) throw new Error("请求失败");
            return res;
          },
        ];

        request(
          { url: "/data", method: "GET", timeout: 5000 },
          reqInterceptors,
          resInterceptors
        ).then(console.log);
      };

      document.getElementById("uploadBtn").onclick = async () => {
        console.log("上传按钮被点击了");
      };
    </script>
  </body>
</html>
